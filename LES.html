

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>LES and Hybrid LES/DNS Support &mdash; PeleC 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Correctness - Verification and Validation" href="VandV.html" />
    <link rel="prev" title="Geometry treatment in PeleC" href="geometry/EB.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> PeleC
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Equations.html">Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Algorithms.html">Numerical Treatment and Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="BoundaryConditions.html">Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="geometry/EB.html">Geometry treatment in PeleC</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">LES and Hybrid LES/DNS Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#models-for-large-eddy-simulations">Models for large eddy simulations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using">Using</a></li>
<li class="toctree-l3"><a class="reference internal" href="#developing">Developing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#explicit-filtering-of-the-hydrodynamic-source-terms">Explicit filtering of the hydrodynamic source terms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Using</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Developing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="VandV.html">Correctness - Verification and Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="PelePhysics.html">PelePhysics</a></li>
<li class="toctree-l1"><a class="reference internal" href="BoxlibBits.html">Development Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PeleC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>LES and Hybrid LES/DNS Support</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/LES.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <blockquote>
<div></div></blockquote>
<div class="section" id="les-and-hybrid-les-dns-support">
<span id="les"></span><h1>LES and Hybrid LES/DNS Support<a class="headerlink" href="#les-and-hybrid-les-dns-support" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>PeleC has support for LES subgrid models for <em>non-reacting</em> flows; documentation is a work in progress.</p>
</div>
<div class="section" id="models-for-large-eddy-simulations">
<h2>Models for large eddy simulations<a class="headerlink" href="#models-for-large-eddy-simulations" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The LES source terms do not currently support EB cut cells.</p>
</div>
<p>PeleC currently supports two LES models, the constant and dynamic
Smagorinsky models. An extensive discussion of the compressible
version of these models can be found in Martín, M. Pino, U. Piomelli,
and G. V. Candler. “Subgrid-Scale Models for Compressible Large-Eddy
Simulations.” Theoretical and Computational Fluid Dynamics 13, no. 5
(2000): 361–76. The constant Smagorinsky model was verified using the
method of manufactured solutions.</p>
<div class="section" id="using">
<h3>Using<a class="headerlink" href="#using" title="Permalink to this headline">¶</a></h3>
<p>To use the LES models, the user must first activate the LES source
terms by doing: <code class="docutils literal notranslate"><span class="pre">pelec.do_les</span> <span class="pre">=</span> <span class="pre">1</span></code>. The default LES model is
constant Smagorinsky. The user can pick the LES model by setting
<code class="docutils literal notranslate"><span class="pre">pelec.les_model</span> <span class="pre">=</span> <span class="pre">NUM</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">les_model</span> <span class="pre">=</span> <span class="pre">0</span></code>: constant Smagorinsky model</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">les_model</span> <span class="pre">=</span> <span class="pre">1</span></code>: dynamic Smagorinsky model</p></li>
</ul>
<p>For the constant Smagorinsky model, the user may define the model
coefficients: <code class="docutils literal notranslate"><span class="pre">pelec.Cs</span></code>, <code class="docutils literal notranslate"><span class="pre">pelec.CI</span></code>, and <code class="docutils literal notranslate"><span class="pre">pelec.PrT</span></code>. These
must be set by the user in the input file as they default to <code class="docutils literal notranslate"><span class="pre">Cs</span> <span class="pre">=</span>
<span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">CI</span> <span class="pre">=</span> <span class="pre">0</span></code>, and <code class="docutils literal notranslate"><span class="pre">PrT</span> <span class="pre">=</span> <span class="pre">1.0</span></code>. To use a typical constant
Smagorinsky model, the user would add the following in the input file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pelec</span><span class="o">.</span><span class="n">do_les</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">les_model</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># TURBULENCE PARAMETERS</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">Cs</span> <span class="o">=</span> <span class="mf">0.16</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">CI</span> <span class="o">=</span> <span class="mf">0.09</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">PrT</span> <span class="o">=</span> <span class="mf">0.7</span>
</pre></div>
</div>
<p>For the dynamic Smagorinsky model, the user can define a test filter
type (<code class="docutils literal notranslate"><span class="pre">les_test_filter_type</span></code>) and filter-grid ratio
(<code class="docutils literal notranslate"><span class="pre">les_test_filter_fgr</span></code>). A complete description of the filter types
and filter-grid ratios can be found in the section on filtering
below. The default test filter type is a box filter with a filter-grid
ratio of 2. An example for activating the dynamic Smagorinsky model is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pelec</span><span class="o">.</span><span class="n">do_les</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">les_model</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">les_test_filter_type</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">les_test_filter_fgr</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="section" id="developing">
<h3>Developing<a class="headerlink" href="#developing" title="Permalink to this headline">¶</a></h3>
<p>The LES models are implemented as source terms in <cite>PeleC_les.cpp</cite> and
the kernels are implemented in <code class="docutils literal notranslate"><span class="pre">Src_DIMd/lesterm_DIMd.f90</span></code>.</p>
</div>
</div>
<div class="section" id="explicit-filtering-of-the-hydrodynamic-source-terms">
<h2>Explicit filtering of the hydrodynamic source terms<a class="headerlink" href="#explicit-filtering-of-the-hydrodynamic-source-terms" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Explicit filtering is a work in progress. It should not be used with wall boundary conditions. Filtering at coarse-fine boundaries is experimental.</p>
</div>
<p>In some instances the user may want to explicitly filter the
Navier-Stokes equations to perform explicitly filtered large eddy
simulations. The objective of explicitly filtering the PDEs is to
remove wavenumber content in the solution that may be contaminated by
numerical error. To achieve this objective, the hydrodynamic source
terms, i.e. the source terms that may introduce wavenumbers that
cannot be represented accurately by the grid, are explicitly filtered
after each computation of the hydrodynamic source terms.</p>
<div class="section" id="id1">
<h3>Using<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>To explicitly filter the hydrodynamic source terms, the following
should option should be turned on in the input file:
<code class="docutils literal notranslate"><span class="pre">pelec.use_explicit_filter</span> <span class="pre">=</span> <span class="pre">1</span></code>. The user specifies the filter-grid
ratio using <code class="docutils literal notranslate"><span class="pre">pelec.les_filter_fgr</span> <span class="pre">=</span> <span class="pre">NUM</span></code>, where <code class="docutils literal notranslate"><span class="pre">NUM</span></code> is the
filter-grid ratio desired, e.g. <code class="docutils literal notranslate"><span class="pre">pelec.les_filter_fgr</span> <span class="pre">=</span> <span class="pre">2</span></code>. The user
also specifies a filter type through <code class="docutils literal notranslate"><span class="pre">pelec.les_filter_type</span> <span class="pre">=</span> <span class="pre">NUM</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">les_filter_type</span> <span class="pre">=</span> <span class="pre">0</span></code>: no filtering</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">les_filter_type</span> <span class="pre">=</span> <span class="pre">1</span></code>: standard box filter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">les_filter_type</span> <span class="pre">=</span> <span class="pre">2</span></code>: standard Gaussian filter</p></li>
</ul>
<p>We have also implemented a set of filters defined in Sagaut &amp; Grohens (1999) Int. J. Num. Meth. Fluids:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">les_filter_type</span> <span class="pre">=</span> <span class="pre">3</span></code>: 3 point box filter approximation (Eq. 26)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">les_filter_type</span> <span class="pre">=</span> <span class="pre">4</span></code>: 5 point box filter approximation (Eq. 27)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">les_filter_type</span> <span class="pre">=</span> <span class="pre">5</span></code>: 3 point box filter optimized approximation (Table 1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">les_filter_type</span> <span class="pre">=</span> <span class="pre">6</span></code>: 5 point box filter optimized approximation (Table 1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">les_filter_type</span> <span class="pre">=</span> <span class="pre">7</span></code>: 3 point Gaussian filter approximation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">les_filter_type</span> <span class="pre">=</span> <span class="pre">8</span></code>: 5 point Gaussian filter approximation (Eq. 29)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">les_filter_type</span> <span class="pre">=</span> <span class="pre">9</span></code>: 3 point Gaussian filter optimized approximation (Table 1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">les_filter_type</span> <span class="pre">=</span> <span class="pre">10</span></code>: 5 point Gaussian filter optimized approximation (Table 1)</p></li>
</ul>
<p>An example input file section for a Gaussian filter with a filter-grid
ration of 2 would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pelec</span><span class="o">.</span><span class="n">use_explicit_filter</span><span class="o">=</span><span class="mi">1</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">les_filter_type</span><span class="o">=</span><span class="mi">2</span>
<span class="n">pelec</span><span class="o">.</span><span class="n">les_filter_fgr</span><span class="o">=</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>Developing<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>The weights for these filters are set in <code class="docutils literal notranslate"><span class="pre">Filter.cpp</span></code>. To add a
filter type, one needs to add an enum to the <code class="docutils literal notranslate"><span class="pre">filter_types</span></code> and
define a corresponding <code class="docutils literal notranslate"><span class="pre">set_NAME_weights</span></code> function to be called at
initialization.</p>
<p>The application of a filter can be done on a Fab or MultiFab. The
implementation is done in <code class="docutils literal notranslate"><span class="pre">filter_DIMd.f90</span></code>. The loop nesting
ordering was chosen to be performant on existing HPC architectures and
discussed in PeleC milestone reports. An example call to the filtering operation is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">les_filter</span> <span class="o">=</span> <span class="n">Filter</span><span class="p">(</span><span class="n">les_filter_type</span><span class="p">,</span> <span class="n">les_filter_fgr</span><span class="p">);</span>
<span class="o">...</span>
<span class="n">les_filter</span><span class="o">.</span><span class="n">apply_filter</span><span class="p">(</span><span class="n">bxtmp</span><span class="p">,</span> <span class="n">flux</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">filtered_flux</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Density</span><span class="p">,</span> <span class="n">NUM_STATE</span><span class="p">);</span>
</pre></div>
</div>
<p>The user must ensure that the correct number of grow cells is present in the Fab or MultiFab.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="VandV.html" class="btn btn-neutral float-right" title="Correctness - Verification and Validation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="geometry/EB.html" class="btn btn-neutral float-left" title="Geometry treatment in PeleC" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright AMReX Copyright (c) 2017, The Regents of the University of California, through Lawrence Berkeley National Laboratory and the Alliance for Sustainable Energy, LLC., through National Renewable Energy Laboratory (subject to receipt of any required approvals from the U.S. Dept. of Energy).  All rights reserved..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>